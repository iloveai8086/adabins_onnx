import torch
basemodel_name = 'tf_efficientnet_b5_ap'

print('Loading base model ()...'.format(basemodel_name), end='')
basemodel = torch.hub.load('rwightman/gen-efficientnet-pytorch', basemodel_name, pretrained=True)
'''
Done.
Removing last two layers (global_pool & classifier).
Building Encoder-Decoder model..Done.
torch.Size([1, 257])
torch.Size([1, 1, 270, 480])
tensor([[1.0000e-03, 6.1087e-01, 6.1819e-01, 6.2551e-01, 6.3283e-01, 6.4015e-01,
         6.4747e-01, 6.5478e-01, 6.6210e-01, 6.6942e-01, 6.7674e-01, 6.8406e-01,
         6.9138e-01, 6.9870e-01, 7.0602e-01, 7.1334e-01, 7.2066e-01, 7.2798e-01,
         7.3530e-01, 7.4262e-01, 7.4994e-01, 7.5726e-01, 7.6458e-01, 7.7190e-01,
         7.7922e-01, 7.8654e-01, 7.9386e-01, 8.0118e-01, 8.0850e-01, 8.1582e-01,
         8.2314e-01, 8.3046e-01, 8.3778e-01, 8.4510e-01, 8.5241e-01, 8.5973e-01,
         8.6705e-01, 8.7437e-01, 8.8169e-01, 8.8901e-01, 8.9633e-01, 9.0365e-01,
         9.1097e-01, 1.3435e+00, 1.3508e+00, 1.3581e+00, 1.3654e+00, 1.3728e+00,
         1.3801e+00, 1.3874e+00, 1.3947e+00, 1.4020e+00, 1.4093e+00, 1.4167e+00,
         1.4240e+00, 1.4313e+00, 1.4386e+00, 1.4459e+00, 1.4533e+00, 1.4606e+00,
         1.4679e+00, 1.4752e+00, 1.4825e+00, 1.4899e+00, 1.4972e+00, 1.5045e+00,
         1.5118e+00, 1.5191e+00, 1.5265e+00, 1.5338e+00, 1.5411e+00, 1.5484e+00,
         1.5557e+00, 1.5631e+00, 1.5704e+00, 1.5777e+00, 1.5850e+00, 1.5923e+00,
         1.5997e+00, 1.6070e+00, 1.6143e+00, 1.6216e+00, 1.6289e+00, 1.6614e+00,
         1.6687e+00, 1.6760e+00, 1.6833e+00, 1.6906e+00, 1.6980e+00, 1.7053e+00,
         1.7126e+00, 1.7199e+00, 1.7915e+00, 1.7989e+00, 1.8062e+00, 1.8135e+00,
         1.8208e+00, 1.8281e+00, 1.8355e+00, 1.8428e+00, 1.8501e+00, 1.8574e+00,
         1.8647e+00, 1.9248e+00, 1.9321e+00, 1.9394e+00, 1.9468e+00, 1.9541e+00,
         1.9614e+00, 1.9687e+00, 1.9760e+00, 1.9834e+00, 1.9907e+00, 1.9980e+00,
         2.0053e+00, 2.0126e+00, 2.0200e+00, 2.0273e+00, 2.0346e+00, 2.0419e+00,
         2.0492e+00, 2.0566e+00, 2.0639e+00, 2.1908e+00, 2.1982e+00, 2.2055e+00,
         2.2128e+00, 2.2201e+00, 2.2274e+00, 2.2348e+00, 2.2421e+00, 2.2494e+00,
         2.2567e+00, 2.2640e+00, 2.2714e+00, 2.2787e+00, 2.2860e+00, 2.2933e+00,
         2.3006e+00, 2.3080e+00, 2.3153e+00, 2.3226e+00, 2.3299e+00, 2.3372e+00,
         2.3446e+00, 2.3519e+00, 2.3592e+00, 2.3665e+00, 2.3738e+00, 2.3812e+00,
         2.3885e+00, 2.3958e+00, 2.4031e+00, 2.4104e+00, 2.5589e+00, 2.7398e+00,
         2.7472e+00, 2.7545e+00, 2.7618e+00, 2.7691e+00, 2.7764e+00, 2.7838e+00,
         2.7911e+00, 2.7984e+00, 2.8057e+00, 2.8130e+00, 2.8204e+00, 2.8277e+00,
         2.8350e+00, 2.8423e+00, 2.8496e+00, 2.8569e+00, 2.8643e+00, 3.0829e+00,
         3.0902e+00, 3.0976e+00, 3.1049e+00, 3.1122e+00, 3.1195e+00, 3.1268e+00,
         3.1342e+00, 3.1415e+00, 3.1488e+00, 3.1561e+00, 3.1634e+00, 3.1708e+00,
         3.1781e+00, 3.1854e+00, 3.1927e+00, 3.2000e+00, 3.2074e+00, 3.2147e+00,
         3.2220e+00, 3.2293e+00, 3.2366e+00, 3.4940e+00, 3.5013e+00, 3.5086e+00,
         3.5159e+00, 3.5233e+00, 3.5306e+00, 3.5379e+00, 3.5452e+00, 3.5525e+00,
         3.5599e+00, 3.5672e+00, 3.5745e+00, 3.5818e+00, 3.5891e+00, 3.5965e+00,
         3.6038e+00, 3.6111e+00, 3.6184e+00, 3.8304e+00, 3.8377e+00, 3.8451e+00,
         3.8524e+00, 3.8597e+00, 3.8670e+00, 3.8743e+00, 3.8817e+00, 3.8890e+00,
         3.8963e+00, 3.9036e+00, 3.9109e+00, 3.9183e+00, 3.9256e+00, 3.9329e+00,
         3.9402e+00, 3.9475e+00, 3.9549e+00, 4.0578e+00, 4.0652e+00, 4.0725e+00,
         4.0798e+00, 4.0871e+00, 4.1697e+00, 4.1771e+00, 4.1844e+00, 4.1917e+00,
         4.1990e+00, 4.2063e+00, 4.2137e+00, 4.2210e+00, 4.3878e+00, 4.3951e+00,
         4.4025e+00, 4.4098e+00, 4.6516e+00, 4.8420e+00, 5.0904e+00, 5.2310e+00,
         5.5009e+00, 5.5082e+00, 6.0716e+00, 7.0489e+00, 1.0000e+01]],
       device='cuda:0')
tensor([[[[2.4226, 2.4557, 2.4597,  ..., 2.5821, 2.5771, 2.5466],
          [2.4593, 2.4698, 2.4758,  ..., 2.6041, 2.6185, 2.6367],
          [2.4753, 2.4754, 2.4867,  ..., 2.6129, 2.6178, 2.6532],
          ...,
          [1.8853, 1.8892, 1.8920,  ..., 1.9446, 1.9478, 1.9383],
          [1.8854, 1.8830, 1.8990,  ..., 1.9344, 1.9371, 1.9304],
          [1.9137, 1.8723, 1.8940,  ..., 1.9148, 1.9216, 1.9540]]]],
       device='cuda:0')

Process finished with exit code 0

'''